<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PDF Tool ‚Äì FINAL</title>

<!-- LIB -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script src="https://unpkg.com/mammoth/mammoth.browser.min.js"></script>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";
</script>

<style>
*{box-sizing:border-box;font-family:system-ui}
body{
margin:0;min-height:100vh;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
color:#fff;padding:12px
}
.app{
max-width:1100px;margin:auto;
background:rgba(255,255,255,.12);
backdrop-filter:blur(14px);
border-radius:22px;padding:20px
}
.tabs{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.tabs button{
padding:10px 18px;border-radius:20px;border:none;
background:rgba(255,255,255,.2);color:#fff;
font-weight:600;cursor:pointer
}
.tabs button.active{
background:linear-gradient(135deg,#00c6ff,#0072ff)
}
.panel{display:none;margin-top:18px}
.panel.active{display:block}
.upload{
border:2px dashed rgba(255,255,255,.35);
padding:26px;text-align:center;
border-radius:16px;cursor:pointer
}
.upload input{display:none}
.grid{
margin-top:20px;
display:grid;
grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
gap:14px
}
.file{
background:rgba(0,0,0,.35);
border-radius:12px;padding:10px
}
.file img{
width:100%;height:120px;
object-fit:cover;border-radius:8px
}
.file-name{
margin-top:6px;font-size:13px;
text-align:center;word-break:break-all
}
.actions{
margin-top:18px;
display:flex;gap:10px;
justify-content:center;flex-wrap:wrap
}
.actions button{
padding:12px 22px;
border-radius:14px;border:none;
background:linear-gradient(135deg,#00c6ff,#0072ff);
color:#fff;font-weight:600;cursor:pointer
}
.loading{
position:fixed;inset:0;
background:rgba(0,0,0,.6);
display:none;align-items:center;justify-content:center;
z-index:999
}
.spinner{
width:60px;height:60px;
border:6px solid #ddd;
border-top-color:#00c6ff;
border-radius:50%;
animation:spin 1s linear infinite
}
@keyframes spin{to{transform:rotate(360deg)}}

/* WORD */
.word-content{
font-family:Arial;
font-size:12pt;
line-height:1.4
}
.word-content table{
width:100%;
border-collapse:collapse
}
.word-content td,
.word-content th{
border:1px solid #444;
padding:4px
}
</style>
</head>

<body>

<div class="loading" id="loading"><div class="spinner"></div></div>

<!-- ===== MAIN APP ===== -->
<div class="app">
<div class="logo"> <img src="https://lh3.googleusercontent.com/a/ACg8ocKmXTXh7YnKdycDCZXMBH_5D79UE14STXrbOZYS0It0WWTTTFf2=s288-c-no"> </div>
<div class="tabs">
<button class="active" onclick="switchTab(0,this)">·∫¢nh ‚Üí PDF</button>
<button onclick="switchTab(1,this)">PDF ‚Üí ·∫¢nh</button>
<button onclick="switchTab(2,this)">Word ‚Üí PDF</button>
</div>

<!-- IMAGE ‚Üí PDF -->
<div class="panel active">
<label class="upload">
<input type="file" id="imgInput" accept="image/*" multiple>
üì∏ Ch·ªçn ho·∫∑c k√©o ·∫£nh
</label>
<div class="actions">
<button onclick="convertImgSingle()">üìÑ G·ªôp ·∫£nh ‚Üí PDF</button>
<button onclick="convertImgMulti()">üìë M·ªói ·∫£nh ‚Üí PDF</button>
<button onclick="download()">‚¨á T·∫£i</button>
</div>
<div class="grid" id="imgGrid"></div>
</div>

<!-- PDF ‚Üí IMAGE -->
<div class="panel">
<label class="upload">
<input type="file" id="pdfInput" accept="application/pdf" multiple>
üìÑ Ch·ªçn PDF
</label>
<div class="actions">
<button onclick="convertPdf()">üñº PDF ‚Üí ·∫¢nh</button>
<button onclick="download()">‚¨á T·∫£i</button>
</div>
<div class="grid" id="pdfGrid"></div>
</div>

<!-- WORD ‚Üí PDF -->
<div class="panel">
<label class="upload">
<input type="file" id="wordInput" accept=".doc,.docx">
üìù Ch·ªçn Word
</label>
<div class="actions">
<button onclick="convertWord()">üìÑ Chuy·ªÉn PDF</button>
<button onclick="download()">‚¨á T·∫£i</button>
</div>
<div class="grid" id="wordGrid"></div>
</div>

</div>

<hr>

<!-- ===== PDF PAGE 2 AUTO ===== -->
<div class="app">
<h2 style="text-align:center">üñº PDF ‚Üí JPG (Trang 2 ‚Ä¢ Auto t·∫£i)</h2>

<label class="upload" id="pdfPage2Drop">
<input type="file" id="pdfPage2Input" accept="application/pdf" multiple>
üìÑ K√©o ho·∫∑c ch·ªçn PDF
</label>

<div class="grid" id="pdfPage2Grid"></div>
</div>

<script>
const { jsPDF } = window.jspdf;
let results=[], pdfPage2Results=[];

/* COMMON */
function showLoading(s){
loading.style.display=s?"flex":"none";
}
function switchTab(i,btn){
document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
btn.classList.add("active");
document.querySelectorAll(".panel").forEach((p,j)=>p.classList.toggle("active",i===j));
results=[];
document.querySelectorAll(".grid").forEach(g=>g.innerHTML="");
}

/* IMAGE PREVIEW */
imgInput.onchange=()=>{
imgGrid.innerHTML="";
[...imgInput.files].forEach(f=>{
imgGrid.innerHTML+=`
<div class="file">
<img src="${URL.createObjectURL(f)}">
<div class="file-name">${f.name}</div>
</div>`;
});
};

/* LOAD IMAGE */
function loadImg(file){
return new Promise(r=>{
const img=new Image();
img.onload=()=>r(img);
img.src=URL.createObjectURL(file);
});
}

/* IMAGE ‚Üí PDF */
async function convertImgSingle(){
showLoading(true);
const pdf=new jsPDF("p","mm","a4");
const pageW=pdf.internal.pageSize.getWidth();
const pageH=pdf.internal.pageSize.getHeight();
const margin=10;
let first=true;

for(const f of imgInput.files){
const img=await loadImg(f);
const ir=img.width/img.height;
const pr=(pageW-margin*2)/(pageH-margin*2);
let w,h;
if(ir>pr){w=pageW-margin*2;h=w/ir;}
else{h=pageH-margin*2;w=h*ir;}
const x=(pageW-w)/2;
const y=(pageH-h)/2;
if(!first) pdf.addPage();
pdf.addImage(img,"JPEG",x,y,w,h);
first=false;
}
results=[{blob:pdf.output("blob"),name:"images.pdf"}];
showLoading(false);
}

async function convertImgMulti(){
showLoading(true);
results=[];
for(const f of imgInput.files){
const pdf=new jsPDF("p","mm","a4");
const pageW=pdf.internal.pageSize.getWidth();
const pageH=pdf.internal.pageSize.getHeight();
const margin=10;
const img=await loadImg(f);
const ir=img.width/img.height;
const pr=(pageW-margin*2)/(pageH-margin*2);
let w,h;
if(ir>pr){w=pageW-margin*2;h=w/ir;}
else{h=pageH-margin*2;w=h*ir;}
pdf.addImage(img,"JPEG",(pageW-w)/2,(pageH-h)/2,w,h);
results.push({blob:pdf.output("blob"),name:f.name.replace(/\..+/,".pdf")});
}
showLoading(false);
}

/* PDF ‚Üí IMAGE */
pdfInput.onchange=()=>{
pdfGrid.innerHTML="";
[...pdfInput.files].forEach(f=>{
pdfGrid.innerHTML+=`
<div class="file">
<img src="https://cdn-icons-png.flaticon.com/512/337/337946.png">
<div class="file-name">${f.name}</div>
</div>`;
});
};

async function convertPdf(){
showLoading(true);
results=[];
pdfGrid.innerHTML="";
for(const file of pdfInput.files){
const buffer=await file.arrayBuffer();
const pdf=await pdfjsLib.getDocument({data:buffer}).promise;
const scale=150/72;
for(let i=1;i<=pdf.numPages;i++){
const page=await pdf.getPage(i);
const vp=page.getViewport({scale});
const c=document.createElement("canvas");
c.width=vp.width;c.height=vp.height;
await page.render({canvasContext:c.getContext("2d"),viewport:vp}).promise;
const blob=await new Promise(r=>c.toBlob(r,"image/jpeg",0.92));
const name=`${file.name.replace(/\.pdf$/i,"")}_page_${i}.jpg`;
results.push({blob,name});
pdfGrid.innerHTML+=`
<div class="file">
<img src="${URL.createObjectURL(blob)}">
<div class="file-name">${name}</div>
</div>`;
}
}
showLoading(false);
}

/* WORD ‚Üí PDF */
wordInput.onchange=()=>{
wordGrid.innerHTML=`
<div class="file">
<img src="https://cdn-icons-png.flaticon.com/512/337/337932.png">
<div class="file-name">${wordInput.files[0].name}</div>
</div>`;
};

async function convertWord(){
showLoading(true);
const buf=await wordInput.files[0].arrayBuffer();
const {value:html}=await mammoth.convertToHtml({arrayBuffer:buf});
const box=document.createElement("div");
box.className="word-content";
box.innerHTML=html;
document.body.appendChild(box);
const pdf=new jsPDF("p","mm","a4");
pdf.html(box,{
margin:[15,15,15,15],
autoPaging:"text",
html2canvas:{scale:1.2},
callback:()=>{
document.body.removeChild(box);
results=[{blob:pdf.output("blob"),name:wordInput.files[0].name.replace(/\..+/,".pdf")}];
showLoading(false);
}
});
}

/* DOWNLOAD */
function download(){
if(!results.length) return alert("Ch∆∞a c√≥ file");
if(results.length===1) return saveAs(results[0].blob,results[0].name);
const zip=new JSZip();
results.forEach(f=>zip.file(f.name,f.blob));
zip.generateAsync({type:"blob"}).then(b=>saveAs(b,"files.zip"));
}

/* PDF PAGE 2 AUTO */
pdfPage2Drop.ondragover=e=>e.preventDefault();
pdfPage2Drop.ondrop=async e=>{
e.preventDefault();
pdfPage2Input.files=e.dataTransfer.files;
await convertPdfPage2();
autoDownloadPage2();
};

async function convertPdfPage2(){
pdfPage2Results=[];
pdfPage2Grid.innerHTML="";
for(const file of pdfPage2Input.files){
const buffer=await file.arrayBuffer();
const pdf=await pdfjsLib.getDocument({data:buffer}).promise;
if(pdf.numPages<2) continue;
const page=await pdf.getPage(2);
const vp=page.getViewport({scale:300/72});
const c=document.createElement("canvas");
c.width=vp.width;c.height=vp.height;
await page.render({canvasContext:c.getContext("2d"),viewport:vp}).promise;
const blob=await new Promise(r=>c.toBlob(r,"image/jpeg",0.95));
const name=file.name.replace(/\.pdf$/i,".jpg");
pdfPage2Results.push({blob,name});
pdfPage2Grid.innerHTML+=`
<div class="file">
<img src="${URL.createObjectURL(blob)}">
<div class="file-name">${name}</div>
</div>`;
}
}

async function autoDownloadPage2(){
if(!pdfPage2Results.length) return;
if(pdfPage2Results.length===1)
return saveAs(pdfPage2Results[0].blob,pdfPage2Results[0].name);
const zip=new JSZip();
pdfPage2Results.forEach(f=>zip.file(f.name,f.blob));
saveAs(await zip.generateAsync({type:"blob"}),"PDF_Page2_Images.zip");
}
</script>

</body>
</html>

